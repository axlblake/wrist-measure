<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>HandLandmarker Docs Version</title>
  <!-- âœ… official CDN from docs -->
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision/vision_bundle.js" crossorigin="anonymous"></script>
</head>
<body>
  <video id="video" autoplay muted playsinline></video>
  <canvas id="canvas"></canvas>

<script>
const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let handLandmarker, drawingUtils;

async function init(){
  const vision = await FilesetResolver.forVisionTasks(
    "https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision/wasm"
  );

  handLandmarker = await HandLandmarker.createFromOptions(vision, {
    baseOptions: {
      modelAssetPath: "https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision/hand_landmarker.task"
    },
    runningMode: "VIDEO",
    numHands: 1
  });

  drawingUtils = new DrawingUtils(ctx);
  startCamera();
}

async function startCamera(){
  const stream = await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});
  video.srcObject = stream;
  video.onloadedmetadata = () => {
    video.play();
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    requestAnimationFrame(loop);
  };
}

async function loop(){
  if(video.readyState === 4 && handLandmarker){
    const now = performance.now();
    const result = await handLandmarker.detectForVideo(video, now);
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

    if(result.landmarks){
      for(const lm of result.landmarks){
        drawingUtils.drawLandmarks(lm, {color:"red", radius:3});
        drawingUtils.drawConnectors(lm, HandLandmarker.HAND_CONNECTIONS, {color:"lime", lineWidth:2});
      }
    }
  }
  requestAnimationFrame(loop);
}

init();
</script>
</body>
</html>
