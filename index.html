<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Hand Camera Test</title>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>
</head>
<body>
  <h3>Hand Camera Test</h3>
  <video id="video" autoplay muted playsinline style="width:320px; height:240px; border:1px solid black;"></video>
  <canvas id="canvas" width="320" height="240" style="border:1px solid red;"></canvas>

<script>
const video=document.getElementById("video");
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");

async function startCamera(){
  try{
    const stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});
    video.srcObject=stream;
    video.play();
    requestAnimationFrame(loop);
  }catch(e){ alert("Camera error: "+e); }
}

const hands=new Hands({locateFile:f=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${f}`});
hands.setOptions({maxNumHands:1,minDetectionConfidence:0.7,minTrackingConfidence:0.7});
hands.onResults(res=>{
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.drawImage(res.image,0,0,canvas.width,canvas.height);
  if(res.multiHandLandmarks){
    for(const lm of res.multiHandLandmarks){
      drawConnectors(ctx,lm,HAND_CONNECTIONS,{color:'#0f0',lineWidth:2});
      drawLandmarks(ctx,lm,{color:'#f00',lineWidth:1});
    }
  }
});

async function loop(){
  if(video.readyState===4){
    await hands.send({image:video});
  }
  requestAnimationFrame(loop);
}

startCamera();
</script>
</body>
</html>
